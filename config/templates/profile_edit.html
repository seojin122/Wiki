<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wiki - í”„ë¡œí•„ ìˆ˜ì •</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb; 
        }
    </style>
</head>
<body class="min-h-screen antialiased flex flex-col">

    {% include 'components/header.html' %}

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex-grow">
        <button onclick="window.location.href='/'" class="flex items-center text-blue-600 hover:text-blue-800 transition duration-150 mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
            <span class="ml-1">ëª¨ì„ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</span>
        </button>
        
        <h2 class="text-3xl font-extrabold text-gray-900 mb-6">âš™ï¸ í”„ë¡œí•„ ì •ë³´ ìˆ˜ì •</h2>
        <p class="text-lg text-gray-600 mb-8">ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§ˆ ë‚˜ì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        
        <div class="bg-white p-8 rounded-xl shadow-2xl border-t-4 border-blue-500">
            <form id="profile-edit-form" method="post" class="space-y-8">
                {% csrf_token %}

                {% if error %}
                    <div class="mb-4 p-3 bg-red-100 text-red-800 rounded-lg text-sm">
                        {{ error }}
                    </div>
                {% endif %}

                {% if messages %}
                    {% for message in messages %}
                        <div class="mb-4 p-3 bg-green-100 text-green-800 rounded-lg text-sm">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
                
                <div class="space-y-6">
                    <h3 class="text-2xl font-bold text-gray-800 border-b pb-2">ê¸°ë³¸ ì •ë³´</h3>

                    <div class="flex items-center space-x-6">
                        <div class="flex-shrink-0">
                            <!-- ì´ë¯¸ì§€ëŠ” í”„ë¡ íŠ¸ ë¯¸ë¦¬ë³´ê¸°ë§Œ, ì„œë²„ ì €ì¥ ì—†ìŒ -->
                            <img id="profile-preview" class="h-24 w-24 rounded-full object-cover border-4 border-gray-100 shadow-inner" 
                                 src="https://via.placeholder.com/96/1D4ED8/FFFFFF?text={{ request.user.nickname|default:'U'|slice:':1' }}" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
                        </div>
                        <div class="space-y-1">
                            <label class="block text-sm font-medium text-gray-700">í”„ë¡œí•„ ì‚¬ì§„</label>
                            <input type="file" id="profile-image-upload" accept="image/*" class="hidden">
                            <button type="button" onclick="document.getElementById('profile-image-upload').click()"
                                class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-2 px-4 rounded-lg transition duration-200">
                                ì´ë¯¸ì§€ ë³€ê²½ (ë¯¸ë¦¬ë³´ê¸°ë§Œ)
                            </button>
                            <p class="text-xs text-gray-500">JPG, PNG íŒŒì¼ (ìµœëŒ€ 5MB) â€” ì„œë²„ì—ëŠ” ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>

                    <div>
                        <label for="nickname" class="block text-sm font-medium text-gray-700 mb-1">ë‹‰ë„¤ì„</label>
                        <input type="text" id="nickname" name="nickname"
                            value="{{ request.POST.nickname|default:request.user.nickname }}"
                            required placeholder="ìƒˆë¡œìš´ ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" maxlength="15">
                        <p class="text-xs text-gray-500 mt-1">15ì ì´ë‚´ë¡œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                    </div>

                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">ì´ë©”ì¼ (ID)</label>
                        <input type="email" id="email"
                            value="{{ request.user.email }}"
                            disabled
                            class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-500 cursor-not-allowed">
                        <p class="text-xs text-gray-500 mt-1">ì´ë©”ì¼ì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="space-y-6 pt-6 border-t border-gray-200">
                    <h3 class="text-2xl font-bold text-gray-800 border-b pb-2">ìƒì„¸ ì •ë³´</h3>

                    <div>
                        <label for="introduction" class="block text-sm font-medium text-gray-700 mb-1">ìê¸°ì†Œê°œ (ì„ íƒ)</label>
                        <textarea id="introduction" name="introduction" rows="4" placeholder="ë‚˜ì˜ ì·¨ë¯¸ë‚˜ ê´€ì‹¬ì‚¬, ëª¨ì„ì—ì„œ ê¸°ëŒ€í•˜ëŠ” ì  ë“±ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”."
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">{% if request.POST.introduction %}{{ request.POST.introduction }}{% else %}{{ request.user.introduction|default_if_none:'' }}{% endif %}</textarea>
                    </div>

                    <div>
                        <label for="region" class="block text-sm font-medium text-gray-700 mb-1">ì„ í˜¸ í™œë™ ì§€ì—­</label>
                        <select id="region" name="region"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                            <option value="SEOUL"   {% if request.user.region == 'SEOUL'   %}selected{% endif %}>ì„œìš¸</option>
                            <option value="GYEONGGI" {% if request.user.region == 'GYEONGGI' %}selected{% endif %}>ê²½ê¸°</option>
                            <option value="INCHEON"  {% if request.user.region == 'INCHEON'  %}selected{% endif %}>ì¸ì²œ</option>
                            <option value="ETC"      {% if request.user.region == 'ETC'      %}selected{% endif %}>ê¸°íƒ€/ì˜¨ë¼ì¸</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-4 pt-6 border-t border-gray-200">
                    <div class="flex justify-between items-center">
                        <p class="text-sm font-medium text-gray-700">ë³´ì•ˆ ì„¤ì •</p>
                    </div>

                    <h3 class="text-2xl font-bold text-gray-800 border-b pb-2">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h3>

                    <p class="text-xs text-gray-500 mb-2">
                        ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì•„ë˜ ì…ë ¥ë€ì„ ë¹„ì›Œë‘ë©´ ë©ë‹ˆë‹¤.
                    </p>

                    <div>
                        <label for="current-password" class="block text-sm font-medium text-gray-700 mb-1">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="current-password" name="current_password" placeholder="í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ë¹„ë°€ë²ˆí˜¸"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500">
                    </div>

                    <div>
                        <label for="new-password" class="block text-sm font-medium text-gray-700 mb-1">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="new-password" name="new_password" placeholder="6ì ì´ìƒì˜ ìƒˆ ë¹„ë°€ë²ˆí˜¸"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-1">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                        <input type="password" id="confirm-password" name="confirm_password" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <button type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 transform hover:scale-[1.005]">
                        ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥
                    </button>
                </div>
            </form>
        </div>
    </main>
        
    {% include 'components/footer.html' %}

    <script>
        document.getElementById('profile-image-upload').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profile-preview').src = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        });
    </script>
</body>
</html>
